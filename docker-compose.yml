services:
  openclaw:
    build: .
    ports:
      - "18789:18789"   # Gateway + WebChat UI
      - "18790:18790"   # Bridge (mobile nodes)
    volumes:
      # Mount config directory - edit config/openclaw.json without rebuilding
      - ./config:/home/openclaw/.openclaw
      # Persist workspace data (memory, skills, WhatsApp credentials)
      - ./workspace:/home/openclaw/clawd
    environment:
      # LLM Provider (at least one required)
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY:-}
      - MINIMAX_API_KEY=${MINIMAX_API_KEY:-}

      # Channel tokens (injected into config automatically)
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN:-}
      - TELEGRAM_ALLOWED_USERS=${TELEGRAM_ALLOWED_USERS:-}
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN:-}
      - SLACK_APP_TOKEN=${SLACK_APP_TOKEN:-}
      - SLACK_BOT_TOKEN=${SLACK_BOT_TOKEN:-}
      - WHATSAPP_ENABLED=${WHATSAPP_ENABLED:-false}
      - WHATSAPP_ALLOWED_NUMBERS=${WHATSAPP_ALLOWED_NUMBERS:-}

      # Gateway auth token (auto-generated if not set)
      - OPENCLAW_GATEWAY_TOKEN=${OPENCLAW_GATEWAY_TOKEN:-}

      # ElevenLabs TTS (for sag command)
      - ELEVENLABS_API_KEY=${ELEVENLABS_API_KEY:-}
      - SAG_VOICE_ID=${SAG_VOICE_ID:-}

      # Set to "true" to regenerate config from env vars
      # - OPENCLAW_REGEN_CONFIG=true
    restart: unless-stopped
